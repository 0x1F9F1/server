set storage_engine='tokudb';
drop table if exists t;
create table t (id int not null primary key, v longblob not null);
insert into t values (1,repeat('a',32*1024*1024));
ERROR HY000: Got error 22 from storage engine
insert into t values (1,repeat('a',32*1024*1024-1));
ERROR HY000: Got error 22 from storage engine
insert into t values (1,repeat('a',32*1024*1024-2));
ERROR HY000: Got error 22 from storage engine
insert into t values (1,repeat('a',32*1024*1024-3));
ERROR HY000: Got error 22 from storage engine
insert into t values (1,repeat('a',32*1024*1024-4));
select id,length(v) from t;
id	length(v)
1	33554428
truncate table t;
insert into t values (1,'a'),(2,'b'),(3,'c'),(4,'d'),(5,repeat('e',32*1024*1024-1));
ERROR HY000: Got error 22 from storage engine
select id,length(v) from t;
id	length(v)
truncate table t;
insert into t values (1,'a'),(2,'b'),(3,'c'),(4,'d');
insert into t values (5,repeat('e',32*1024*1024-1));
ERROR HY000: Got error 22 from storage engine
select id,length(v) from t;
id	length(v)
1	1
2	1
3	1
4	1
drop table t;
