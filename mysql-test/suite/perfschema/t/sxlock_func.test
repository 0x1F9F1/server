# Performance schema tests, for SX-lock
# Note that only Innodb provides instrumented SX-locks,
# so this test depends largely on the innodb instrumentation.

--source include/not_embedded.inc
--source include/have_perfschema.inc
--source include/have_innodb.inc

UPDATE performance_schema.setup_instruments SET enabled = 'NO', timed = 'YES';

UPDATE performance_schema.setup_instruments SET enabled = 'YES'
WHERE name like 'wait/synch/sxlock/%';

select distinct name from performance_schema.setup_instruments
where name like "wait/synch/rwlock/innodb%"
and name!='wait/synch/rwlock/innodb/btr_search_latch' order by name;

select distinct name from performance_schema.rwlock_instances
  where name like 'wait/synch/sxlock/%'
  order by name;

UPDATE performance_schema.setup_instruments SET enabled = 'YES', timed = 'YES';

