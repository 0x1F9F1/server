# tests that deletes are cleaned by verifying that row estimate goes down
SET STORAGE_ENGINE = 'tokudb';

--disable_warnings
DROP TABLE IF EXISTS foo;
--enable_warnings

create table foo (a int, b int, primary key (a))engine=TokuDB;
insert into foo values (1,10),(2,20),(3,30),(4,40),(5,50),(6,60),(7,70),(8,80),(9,90);
insert into foo values (10,100),(20,200),(30,300),(40,400),(50,500),(60,600),(70,700),(80,800),(90,900);
--echo # row estimate should be 6
explain select count(*) from foo where a > 30;
select count(*) from foo where a > 30;

delete from foo where a > 50;

--echo # row estimate should be 2
explain select count(*) from foo where a > 30;
select count(*) from foo where a > 30;


DROP TABLE foo;