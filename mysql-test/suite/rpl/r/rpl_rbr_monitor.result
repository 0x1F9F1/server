include/master-slave.inc
[connection master]
connection master;
create table t1(a int primary key);
connection slave;
SET GLOBAL debug_dbug="+d,should_sleep_for_mdev7409";
select * from t1;
a
connection master;
insert into t1(a) values(1);
#monitoring write rows
connection slave;
SELECT db , state  FROM  INFORMATION_SCHEMA.PROCESSLIST
WHERE DB = 'test' AND STATE LIKE  "Write_rows_log_event::write_row(%) on table t1";
db	state
test	Write_rows_log_event::write_row(-1) on table t1
#monitoring update rows
connection master;
update t1 set a = a + 4194304 ;
connection slave;
SELECT db, state  FROM  INFORMATION_SCHEMA.PROCESSLIST
WHERE DB = 'test' AND STATE LIKE  "Update_rows_log_event::find_row(%) on table t1";
db	state
test	Update_rows_log_event::find_row(-1) on table t1
SELECT db, state FROM  INFORMATION_SCHEMA.PROCESSLIST
WHERE DB = 'test' AND STATE LIKE  "Update_rows_log_event::unpack_current_row(%) on table t1";
db	state
test	Update_rows_log_event::unpack_current_row(-1) on table t1
SELECT db, state  FROM  INFORMATION_SCHEMA.PROCESSLIST
WHERE DB = 'test' AND STATE LIKE  "Update_rows_log_event::ha_update_row(%) on table t1";
db	state
test	Update_rows_log_event::ha_update_row(-1) on table t1
#monitoring delete rows
connection master;
delete from t1 where a>1;
connection slave;
SELECT db , state FROM  INFORMATION_SCHEMA.PROCESSLIST
WHERE DB = 'test' AND STATE LIKE  "Delete_rows_log_event::find_row(%) on table t1";
db	state
test	Delete_rows_log_event::find_row(-1) on table t1
SELECT db, state  FROM  INFORMATION_SCHEMA.PROCESSLIST
WHERE DB = 'test' AND STATE LIKE  "Delete_rows_log_event::ha_delete_row(%) on table t1";
db	state
test	Delete_rows_log_event::ha_delete_row(-1) on table t1
connection master;
drop table t1;
connection slave;
SET GLOBAL debug_dbug="";
include/rpl_end.inc
connection server_2;
connection server_2;
connection server_2;
connection server_2;
connection server_1;
connection server_1;
connection server_1;
connection server_2;
connection server_1;
connection server_2;
connection server_2;
connection server_1;
connection server_1;
